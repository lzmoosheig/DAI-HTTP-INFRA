version: '3.9'
services:
  static:
    container_name: apache-php-image
    image: dai/apache_php
    ports:
      - "9090:80"
      
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.static.rule=Host(`localhost`)"
      - "traefik.http.services.static.loadbalancer.server.port=8080"
     
    restart: unless-stopped
 
  dynamic:
    container_name: express-image
    image: dai/express_passwords
    ports:
      - "7777:7777"
      
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.dynamic.rule=(Host(`localhost`) && PathPrefix(`/api`))"
      - "traefik.http.services.dynamic.loadbalancer.server.port=8080"
     
    restart: unless-stopped
    
  reverse-proxy:
   # The official v2 Traefik docker image
   image: traefik:v2.9
   # Enables the web UI and tells Traefik to listen to docker
   command: --api.insecure=true --providers.docker
   ports:
      # The HTTP port
     - "80:80"
      # The Web UI (enabled by --api.insecure=true)
     - "8080:8080"
   volumes:
     # So that Traefik can listen to the Docker events
     - /var/run/docker.sock:/var/run/docker.sock